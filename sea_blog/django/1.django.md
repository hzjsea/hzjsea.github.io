---
title: djangoå®é™…é¡¹ç›®ä¸­çš„æ¨¡å—è®¾è®¡
categories:
  - ç¼–ç¨‹
tags:
  - django
abbrlink: c83ed08b
date: 2020-02-14 01:53:20
---

learn django ğŸ¢
<!-- more -->


# djangoå®é™…æ¨¡å—è®¾è®¡



## å¤šçº§è”åŠ¨èœå•è®¾è®¡

æ•°æ®åº“è®¾è®¡
```bash
class MenusModel(models.Model):
    "èœå•ç±»åˆ«"
    MENU_TYPE=(
        (1, "ä¸€çº§ç±»ç›®"),
        (2, "äºŒçº§ç±»ç›®"),
    )
    name = models.CharField(max_length=10,verbose_name="èœå•æ åå­—")
    icon = models.CharField(max_length=20,verbose_name="èœå•æ å›¾æ ‡")
    path = models.CharField(max_length=20,verbose_name="èœå•æ æŒ‡å‘è·¯å¾„")
    menu_type = models.CharField(choices=MENU_TYPE,verbose_name="èœå•ç±»åˆ«",max_length=1)
    parent = models.ForeignKey('self', default=0, null=True, blank=True, related_name='children', \
                               verbose_name='çˆ¶åˆ†ç±»',on_delete=models.CASCADE)
    class Meta:
        verbose_name = "èœå•æ åå­—"
        verbose_name_plural = verbose_name 
```
![2020-02-14-01-55-00](http://img.noback.top/2020-02-14-01-55-00.png)

åºåˆ—åŒ–è®¾è®¡
```bash
# äºŒçº§èœå•ç­›é€‰
class MenusSerializer2(serializers.ModelSerializer):
    class Meta:
        model = MenusModel
        fields = "__all__"

# ä¸€çº§èœå•ç­›é€‰
class MenusSerializer(serializers.ModelSerializer):
    children = MenusSerializer2(many=True)
    class Meta:
        model = MenusModel
        fields = "__all__" 
```

viewè§†å›¾è®¾è®¡
```bash
class MenuVeiw(viewsets.GenericViewSet,
               mixins.ListModelMixin):
    queryset = MenusModel.objects.filter(menu_type=1)
    serializer_class = MenusSerializer
```

æ•ˆæœ
![2020-02-14-01-57-08](http://img.noback.top/2020-02-14-01-57-08.png)


## å¤šçº§è”åŠ¨èœå•è®¾è®¡2

æ•°æ®åº“è®¾è®¡
```bash
class GoodsCategory(BaseModel):
 # """
 # å•†å“ç±»åˆ«
 # """

 class MenusModel(models.Model):
    "èœå•ç±»åˆ«"
    MENU_TYPE=(
        (1, "ä¸€çº§ç±»ç›®"),
        (2, "äºŒçº§ç±»ç›®"),
    )
    name = models.CharField(max_length=10,verbose_name="èœå•æ åå­—")
    icon = models.CharField(max_length=20,verbose_name="èœå•æ å›¾æ ‡")
    path = models.CharField(max_length=20,verbose_name="èœå•æ æŒ‡å‘è·¯å¾„")
    menu_type = models.CharField(choices=MENU_TYPE,verbose_name="èœå•ç±»åˆ«",max_length=1)
    parent = models.ForeignKey('self', default=0, null=True, blank=True, related_name='children', \
                               verbose_name='çˆ¶åˆ†ç±»',on_delete=models.CASCADE)
    class Meta:
        db_name = menu_db
        verbose_name = "èœå•æ åå­—"
        verbose_name_plural = verbose_name 
```

åºåˆ—åŒ–è®¾è®¡ï¼Œåˆ©ç”¨æ•°æ®åº“çš„åå‘æŸ¥è¯¢
```bash
from rest_framework import serializers
from .models import GoodsCategory

class CategorySerializer3(serializers.ModelSerializer):
    class Meta:
        model = GoodsCategory
        fields = "__all__"


class CategorySerializer2(serializers.ModelSerializer):
    sub_cat = CategorySerializer3(many=True)
    class Meta:
        model = GoodsCategory
        fields = "__all__"


class CategorySerializer(serializers.ModelSerializer):
    sub_cat = CategorySerializer2(many=True)
    class Meta:
        model = GoodsCategory
        fields = "__all__" 
```

viewè®¾è®¡
```bash
class CategoryInfoView(mixins.ListModelMixin,GenericAPIView):
    queryset = GoodsCategory.objects.filter(parent=None)
    serializer_class = CategorySerializer
    def get(self,request):
        return self.list(request) 
```

æ•ˆæœ
![2020-02-14-01-57-08](http://img.noback.top/2020-02-14-01-57-08.png)



## æŠ¥é”™
```bash
$ python3 manage.py runserver 0.0.0.0:8888
Watching for file changes with StatReloader 

```
ç«¯å£è¢«å ç”¨ killæˆ–è€…é‡å¯å…¶ä»–ç«¯å£